if make_pyclical
  PYCLICAL = pyclical
  PYCLICAL_DEMOS = pyclical/demos
  INSTALL_PYCLICAL_DEMOS = install-pyclical-demos
endif

TIMING = gfft_test products squaring transforms

TOPSUBDIRS = glucat $(PYCLICAL) $(PYCLICAL_DEMOS) $(TIMING) $(DOC)

EXAMPLES = test00 test01 test02 test03 test04 test05 test06 test07 test08 test09 test10 test11 test12 test13 test14 test15 test16

TESTOUT = test00/test00.out test01/test01.out test02/test02.out test03/test03.out test04/test04.out test05/test05.out \
          test06/test06.out test07/test07.out test08/test08.out test09/test09.out test10/test10.out test11/test11.out \
          test12/test12.out test13/test13.out test14/test14.out test15/test15.out test16/test16.out

DOC = doc

doc_DATA = AUTHORS COPYING ChangeLog glucat.lsm INSTALL NEWS README TODO

EXTRA_DIST = admin m4 test test_runtime $(EXAMPLES) configure.ac.in configure.ac configure Makefile.am $(doc_DATA)

check: test-out

test-out: $(TESTOUT)
	cat $(TESTOUT) > test_runtime/test.out

if HAVE_DOXYGEN
$(DOC):
	$(MAKE) -C $(DOC)
endif

$(TESTOUT):
	rm -f test_runtime/test.out
	$(MAKE) -C $(@D) check

install-doc:
	-$(MAKE) -C $(DOC) install-data
	rm -rf autom4te.cache

$(top_srcdir)/configure.ac: configure.ac.in $(top_srcdir)/subdirs
	cd $(top_srcdir) && $(MAKE) -f admin/Makefile.common configure.ac ;

$(top_srcdir)/configure.files:
	cd $(top_srcdir) && $(MAKE) -f admin/Makefile.common configure.files ;

$(top_srcdir)/subdirs:
	cd $(top_srcdir) && $(MAKE) -f admin/Makefile.common subdirs ;

MAINTAINERCLEANFILES = subdirs configure.in acinclude.m4 configure.files

cvs:
	$(MAKE) -f admin/Makefile.common cvs

clean-local:
	-for d in $(DOC) $(PYCLICAL) $(PYCLICAL)/demos $(EXAMPLES); do \
	  $(MAKE) -C $$d clean; \
	done

distclean-local:
	-for d in $(DOC) $(PYCLICAL) $(PYCLICAL)/demos $(EXAMPLES); do \
	  $(MAKE) -C $$d distclean; \
	done

dist-hook:
	cd $(top_distdir) && $(MAKE) -f admin/Makefile.common subdirs
	cd $(top_distdir) && rm -rf */.deps

.PHONY: doc test-out install-doc $(INSTALL_PYCLICAL_DEMOS)
